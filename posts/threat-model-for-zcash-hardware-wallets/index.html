<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Liste - https://zecsec.com/"><title>A Simple Threat Model for Zcash Shielded Hardware Wallets | ZecSec: Zcash Ecosystem Security</title><meta name=description content="Zcash Ecosystem Security Support"><meta property="og:title" content="A Simple Threat Model for Zcash Shielded Hardware Wallets"><meta property="og:description" content="In this post, we&rsquo;ll share a simple threat model for Zcash shielded hardware wallets. This is useful for informing users about which security and privacy properties they can expect to rely on when using a shielded hardware wallet and to help security auditors understand what counts as a &ldquo;security bug.&rdquo;
To define a threat model for Zcash shielded hardware wallets, we consider the following scenario:
The user initially sets up their hardware wallet using a PC or smartphone which is fully compromised by the attacker."><meta property="og:type" content="article"><meta property="og:url" content="https://zecsec.com/posts/threat-model-for-zcash-hardware-wallets/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-15T00:00:00-07:00"><meta property="article:modified_time" content="2023-04-15T00:00:00-07:00"><meta itemprop=name content="A Simple Threat Model for Zcash Shielded Hardware Wallets"><meta itemprop=description content="In this post, we&rsquo;ll share a simple threat model for Zcash shielded hardware wallets. This is useful for informing users about which security and privacy properties they can expect to rely on when using a shielded hardware wallet and to help security auditors understand what counts as a &ldquo;security bug.&rdquo;
To define a threat model for Zcash shielded hardware wallets, we consider the following scenario:
The user initially sets up their hardware wallet using a PC or smartphone which is fully compromised by the attacker."><meta itemprop=datePublished content="2023-04-15T00:00:00-07:00"><meta itemprop=dateModified content="2023-04-15T00:00:00-07:00"><meta itemprop=wordCount content="483"><meta itemprop=keywords content><link rel=canonical href=https://zecsec.com/posts/threat-model-for-zcash-hardware-wallets/><link rel="shortcut icon" type=image/png href=/favicon-32.png><link rel="shortcut icon" sizes=32x32 href=/favicon-32.png><link rel=dns-prefetch href=https://www.google-analytics.com><link href=https://www.google-analytics.com rel=preconnect crossorigin><link rel=alternate type=application/atom+xml title="ZecSec: Zcash Ecosystem Security" href=https://zecsec.com//atom.xml><link rel=alternate type=application/json title="ZecSec: Zcash Ecosystem Security" href=https://zecsec.com//feed.json><link rel="shortcut icon" type=image/png href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII="><style>*,:after,:before{box-sizing:border-box;padding:0}body{font:1rem/1.5 '-apple-system',BlinkMacSystemFont,avenir next,avenir,helvetica,helvetica neue,ubuntu,roboto,noto,segoe ui,arial,sans-serif;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;padding:2rem;background:#f5f5f5;color:#000}.skip-link{position:absolute;top:-40px;left:0;background:#eee;z-index:100}.skip-link:focus{top:0}h1,h2,h3,h4,h5,strong,b{font-size:inherit;font-weight:600}h2{font-size:1.5em}h3{font-size:1.2em;color:#454545}header{line-height:2;padding-bottom:1.5rem}.link{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.time{font-variant-numeric:tabular-nums;white-space:nowrap}blockquote{border-left:5px solid #eee;padding-left:1rem;margin:0}a,a:visited{color:inherit}a:hover,a.heading-link{text-decoration:none}pre{padding:.5rem;overflow:auto;overflow-x:scroll;overflow-wrap:normal}code,pre{font-family:San Francisco Mono,Monaco,consolas,lucida console,dejavu sans mono,bitstream vera sans mono,monospace;font-size:normal;font-size:small;background:#eee}code{margin:.1rem;border:none}ul{list-style-type:square}ul,ol{padding-left:1.2rem}.list{line-height:2;list-style-type:none;padding-left:0}.list li{padding-bottom:.1rem}.meta{color:#777}.content{max-width:70ch;margin:0 auto}header{line-height:2;display:flex;justify-content:space-between;padding-bottom:1rem}header a{text-decoration:none}header ul{list-style-type:none;padding:0}header li,header a{display:inline}h2.post{padding-top:.5rem}header ul a:first-child{padding-left:1rem}.nav{height:1px;background:#000;content:'';max-width:10%}.list li{display:flex;align-items:baseline}.list li time{flex:initial}.hr-list{margin-top:0;margin-bottom:0;margin-right:.5rem;margin-left:.5rem;height:1px;border:0;border-bottom:1px dotted #ccc;flex:1 0 1rem}.m,hr{border:0;margin:3rem 0}img{max-width:100%;height:auto}h2.post{margin-bottom:0}.post-date{margin:0% 0;color:#9a9a9a}.index-date{color:#9a9a9a}.animate-blink{animation:opacity 50s infinite;opacity:1;display:none}@keyframes opacity{0%{opacity:1}50%{opacity:.5}100%{opacity:0}}.tags{display:flex;justify-content:space-between}.tags ul{padding:0;margin:0}.tags li{display:inline}.avatar{height:120px;width:120px;position:relative;margin:-10px 0 0 15px;float:right;border-radius:50%}.table{width:100%;margin-bottom:1rem;color:#111}.table-bordered{border:1px solid #dee2e6}table{border-collapse:collapse}.table-bordered thead th,.table-bordered thead td{border-bottom-width:2px}.table thead th{vertical-align:bottom;border-bottom:2px solid #dee2e6;border-bottom-width:2px}.table-bordered th,.table-bordered td{border:1px solid #dee2e6;border-bottom-color:#dee2e6;border-bottom-style:solid;border-bottom-width:1px}.table th,.table td{padding:.75rem;vertical-align:top;border-top:1px solid #dee2e6}th{text-align:inherit}.table-bordered th,.table-bordered td{border:1px solid #dee2e6}.table th,.table td{padding:.75rem;vertical-align:top;border-top:1px solid #dee2e6}.table{width:100%;margin-bottom:1rem;color:#111}.table th,.table td{padding:.75rem;vertical-align:top;border-top:1px solid #dee2e6}.table thead th{vertical-align:bottom;border-bottom:2px solid #dee2e6}.table tbody+tbody{border-top:2px solid #dee2e6}.table-sm th,.table-sm td{padding:.3rem}.table-bordered{border:1px solid #dee2e6}.table-bordered th,.table-bordered td{border:1px solid #dee2e6}.table-bordered thead th,.table-bordered thead td{border-bottom-width:2px}.table-borderless th,.table-borderless td,.table-borderless thead th,.table-borderless tbody+tbody{border:0}.table-striped tbody tr:nth-of-type(odd){background-color:rgba(0,0,0,5%)}.table-hover tbody tr:hover{color:#111;background-color:rgba(0,0,0,.075)}.table-primary,.table-primary>th,.table-primary>td{background-color:#b8daff}.table-primary th,.table-primary td,.table-primary thead th,.table-primary tbody+tbody{border-color:#7abaff}.table-hover .table-primary:hover{background-color:#9fcdff}.table-hover .table-primary:hover>td,.table-hover .table-primary:hover>th{background-color:#9fcdff}.table-secondary,.table-secondary>th,.table-secondary>td{background-color:#d6d8db}.table-secondary th,.table-secondary td,.table-secondary thead th,.table-secondary tbody+tbody{border-color:#b3b7bb}.table-hover .table-secondary:hover{background-color:#c8cbcf}.table-hover .table-secondary:hover>td,.table-hover .table-secondary:hover>th{background-color:#c8cbcf}.table-success,.table-success>th,.table-success>td{background-color:#c3e6cb}.table-success th,.table-success td,.table-success thead th,.table-success tbody+tbody{border-color:#8fd19e}.table-hover .table-success:hover{background-color:#b1dfbb}.table-hover .table-success:hover>td,.table-hover .table-success:hover>th{background-color:#b1dfbb}.table-info,.table-info>th,.table-info>td{background-color:#bee5eb}.table-info th,.table-info td,.table-info thead th,.table-info tbody+tbody{border-color:#86cfda}.table-hover .table-info:hover{background-color:#abdde5}.table-hover .table-info:hover>td,.table-hover .table-info:hover>th{background-color:#abdde5}.table-warning,.table-warning>th,.table-warning>td{background-color:#ffeeba}.table-warning th,.table-warning td,.table-warning thead th,.table-warning tbody+tbody{border-color:#ffdf7e}.table-hover .table-warning:hover{background-color:#ffe8a1}.table-hover .table-warning:hover>td,.table-hover .table-warning:hover>th{background-color:#ffe8a1}.table-danger,.table-danger>th,.table-danger>td{background-color:#f5c6cb}.table-danger th,.table-danger td,.table-danger thead th,.table-danger tbody+tbody{border-color:#ed969e}.table-hover .table-danger:hover{background-color:#f1b0b7}.table-hover .table-danger:hover>td,.table-hover .table-danger:hover>th{background-color:#f1b0b7}.table-light,.table-light>th,.table-light>td{background-color:#fdfdfe}.table-light th,.table-light td,.table-light thead th,.table-light tbody+tbody{border-color:#fbfcfc}.table-hover .table-light:hover{background-color:#ececf6}.table-hover .table-light:hover>td,.table-hover .table-light:hover>th{background-color:#ececf6}.table-dark,.table-dark>th,.table-dark>td{background-color:#c6c8ca}.table-dark th,.table-dark td,.table-dark thead th,.table-dark tbody+tbody{border-color:#95999c}.table-hover .table-dark:hover{background-color:#b9bbbe}.table-hover .table-dark:hover>td,.table-hover .table-dark:hover>th{background-color:#b9bbbe}.table-active,.table-active>th,.table-active>td{background-color:rgba(0,0,0,.075)}.table-hover .table-active:hover{background-color:rgba(0,0,0,.075)}.table-hover .table-active:hover>td,.table-hover .table-active:hover>th{background-color:rgba(0,0,0,.075)}.table .thead-dark th{color:#fff;background-color:#343a40;border-color:#454d55}.table .thead-light th{color:#495057;background-color:#e9ecef;border-color:#dee2e6}.table-dark{color:#fff;background-color:#343a40}.table-dark th,.table-dark td,.table-dark thead th{border-color:#454d55}.table-dark.table-bordered{border:0}.table-dark.table-striped tbody tr:nth-of-type(odd){background-color:rgba(255,255,255,5%)}.table-dark.table-hover tbody tr:hover{color:#fff;background-color:rgba(255,255,255,.075)}@media(max-width:575.98px){.table-responsive-sm{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.table-responsive-sm>.table-bordered{border:0}}@media(max-width:767.98px){.table-responsive-md{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.table-responsive-md>.table-bordered{border:0}}@media(max-width:991.98px){.table-responsive-lg{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.table-responsive-lg>.table-bordered{border:0}}@media(max-width:1199.98px){.table-responsive-xl{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.table-responsive-xl>.table-bordered{border:0}}.table-responsive{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}.table-responsive>.table-bordered{border:0}</style><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","name":"A Simple Threat Model for Zcash Shielded Hardware Wallets","headline":"A Simple Threat Model for Zcash Shielded Hardware Wallets","alternativeHeadline":"","description":"In this post, we\u0026rsquo;ll share a simple threat model for Zcash shielded hardware wallets. This is useful for informing users about which security and privacy properties they can expect to rely on when using a shielded hardware wallet and to help security auditors understand what counts as a \u0026ldquo;security bug.\u0026rdquo;\nTo define a threat model for Zcash shielded hardware wallets, we consider the following scenario:\nThe user initially sets up their hardware wallet using a PC or smartphone which is fully compromised by the attacker.","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/zecsec.com\/posts\/threat-model-for-zcash-hardware-wallets\/"},"author":{"@type":"Person","name":"Taylor Hornby"},"creator":{"@type":"Person","name":"Taylor Hornby"},"accountablePerson":{"@type":"Person","name":"Taylor Hornby"},"copyrightHolder":"ZecSec: Zcash Ecosystem Security","copyrightYear":"2023","dateCreated":"2023-04-15T00:00:00.00Z","datePublished":"2023-04-15T00:00:00.00Z","dateModified":"2023-04-15T00:00:00.00Z","publisher":{"@type":"Organization","name":"ZecSec: Zcash Ecosystem Security","url":"https://zecsec.com/","logo":{"@type":"ImageObject","url":"https:\/\/zecsec.com\/static\/favicon-32.png","width":"32","height":"32"}},"image":"https://zecsec.com/static/favicon-32.png","url":"https:\/\/zecsec.com\/posts\/threat-model-for-zcash-hardware-wallets\/","wordCount":"483","genre":[],"keywords":[]}</script></head><body><a class=skip-link href=#main>Skip to main</a><main id=main><div class=content><header><p style=padding:0;margin:0><a href=/><b>ZecSec: Zcash Ecosystem Security</b>
<span class="text-stone-500 animate-blink">▮</span></a></p><ul style=padding:0;margin:0><li><a href=/posts/><span>Blog</span></a><li><a href=/overview/><span>Overview</span></a><li><a href=/posts/zecsec-roadmap-for-2023/><span>Roadmap</span></a><li><a href=/contact/><span>Contact</span></a></li></ul></header><hr class=hr-list style=padding:0;margin:0><section><h2 class=post>A Simple Threat Model for Zcash Shielded Hardware Wallets</h2><div class=post-date><span class="g time">April 15, 2023</span> &#8729;
By Taylor Hornby</div><p>In this post, we&rsquo;ll share a simple threat model for Zcash shielded hardware
wallets. This is useful for informing users about which security and privacy
properties they can expect to rely on when using a shielded hardware wallet and
to help security auditors understand what counts as a &ldquo;security bug.&rdquo;</p><p>To define a threat model for Zcash shielded hardware wallets, we consider the
following scenario:</p><ol><li>The user initially sets up their hardware wallet using a PC or smartphone
which is fully compromised by the attacker. The user is careful to back up their
seed phrase and never enter it into the compromised PC/phone.</li><li>The user sends funds to their hardware wallet, using the addresses displayed
on its dedicated screen.</li><li>The user spends funds, carefully checking the transaction details displayed
on the dedicated screen are correct, and only approving the transaction on the
device when all details are as expected.</li></ol><p>Within this scenario, we define the threat model in terms of what expectations
the user has regarding the attacker who has compromised their PC/phone,
following the process of <a href=https://github.com/defuse/ictm>Invariant-Centric Threat
Modelling</a>.</p><p>We expect that the attacker <em>CAN</em>:</p><ol><li>Prevent the user from using their wallet on that compromised PC/phone (but not
others).</li><li>Steal viewing keys which let the attacker permanently compromise the privacy
of the wallet&rsquo;s addresses.</li><li>Cause funds being spent by the user to be stolen, if the user did not
carefully verify the transaction details on the device&rsquo;s screen.</li><li>Cause funds that the user is receiving to be stolen, if they did not verify
their address on the device&rsquo;s screen or if they used the compromised PC/phone to
transmit their address (e.g. the attacker could replace the user&rsquo;s address with
their own after the user pastes it into an exchange&rsquo;s website).</li><li>Cause transactions to be generated in a way that weakens privacy (e.g. by
causing randomized signatures to not be randomized, or by tagging transactions
such that the sender&rsquo;s identity is revealed on the public blockchain).</li></ol><p>The user expects that the attacker <em>CANNOT</em>:</p><ol><li>Obtain the spend authority keys for any of the user&rsquo;s addresses.</li><li>Cause the user&rsquo;s funds to become unspendable.</li><li>Spend the user&rsquo;s funds without physical approval on the hardware device.</li><li>Produce a transaction whose semantics are different in any way from what was approved through the device&rsquo;s display, including changing the destination of funds being spent, the amount of funds being spent, or the fee amount.</li><li>Cause the hardware wallet to display, as its own address, any other address, such as one an attacker controls.</li><li>Cause an official-looking message to be displayed on the hardware wallet&rsquo;s display (which could be used for phishing).</li><li>Permanently prevent the hardware wallet from functioning with another uncompromised PC/phone.</li></ol><p>In addition to these specialized considerations for shielded hardware wallets, a
PC or smartphone wallet app that interfaces with a shielded hardware wallet is
expected to fall under the scope of the <a href=https://zcash.readthedocs.io/en/latest/rtd_pages/wallet_threat_model.html>Zcash Wallet App Threat
Model</a>.</p></section><div id=comments><script src=https://utteranc.es/client.js repo=ZgotmplZ issue-term=pathname theme=ZgotmplZ crossorigin=anonymous async></script></div></div></main></body></html>